# üîê Vulnerability Reproduction: 2FA Secret Remains Obtainable After 2FA is Enabled

## üß† Summary
A weak 2FA implementation exposes the TOTP secret even after 2FA is enabled, allowing an attacker to continuously generate valid OTPs. This leads to complete 2FA bypass if credentials are compromised.

---

## ‚úÖ Reproduction Steps

### 1. Create or Use a Test Account
- Register a new account or use an existing one on the target application.

---

### 2. Enable 2FA
- Navigate to the 2FA setup section.
- A QR code or Base32 secret (e.g., `JBSWY3DPEHPK3PXP`) will be shown.
- Save this secret for later comparison.
- Complete the setup by entering the OTP from your authenticator app.

---

### 3. Confirm 2FA is Enabled
- Ensure 2FA is active and required for login.

---

### 4. Open Developer Tools
- Press `F12` or `Ctrl+Shift+I` to open browser developer tools.
- Go to the **Network** tab.
- Refresh the 2FA settings or profile page.

---

### 5. Check for Secret Leakage
Look for the TOTP secret in any of the following:

- API responses (e.g., `/api/user`, `/api/2fa`, `/settings`)
- HTML source (`Ctrl+U`)
- JavaScript variables
- Cookies or `localStorage`

**Example leaked payload:**
```json
{
  "2fa_enabled": true,
  "2fa_secret": "JBSWY3DPEHPK3PXP"
}
